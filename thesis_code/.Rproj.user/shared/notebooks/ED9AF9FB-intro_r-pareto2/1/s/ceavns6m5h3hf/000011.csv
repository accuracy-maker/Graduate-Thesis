"0","# Load required libraries"
"0","# Load required libraries"
"0","library(ggplot2)"
"0",""
"0","# Parameters"
"0","set.seed(123)"
"0","n <- 100000  # number of samples"
"0","d <- 3       # dimension"
"0","u <- 6       # threshold"
"0",""
"0","# 1. Simulate Exponential(1) samples (Pareto tails)"
"0","X <- matrix(rexp(n * d, rate = 1), ncol = d)"
"0","L1_norm <- rowSums(X)"
"0",""
"0","# 2. Monte Carlo approximation of kappa_D(A)"
"0","p_mc <- mean(L1_norm > u)"
"0",""
"0","# 3. Maximum Likelihood Estimation (MLE) of lambda for exponential margins"
"0","lambda_mle <- 1 / mean(X)  # since mean of Exp(lambda) = 1 / lambda"
"0",""
"0","# 4. Analytical approximation using estimated lambda"
"0","p_analytic_mle <- 1 - pgamma(u, shape = d, rate = lambda_mle)"
"0",""
"0","# 5. Analytical approximation using true lambda = 1"
"0","p_analytic_true <- 1 - pgamma(u, shape = d, rate = 1)"
"0",""
"0","# 6. Print all results"
"0","cat(""Monte Carlo estimate      : "", round(p_mc, 5), ""\n"")"
"1","Monte Carlo estimate      : "
"1"," "
"1","0.06116"
"1"," "
"1","
"
"0","cat(""Analytic (true λ = 1)     : "", round(p_analytic_true, 5), ""\n"")"
"1","Analytic (true λ = 1)     : "
"1"," "
"1","0.06197"
"1"," "
"1","
"
"0","cat(""Analytic (MLE λ ="", round(lambda_mle, 5), ""):"", round(p_analytic_mle, 5), ""\n"")"
"1","Analytic (MLE λ ="
"1"," "
"1","1.00289"
"1"," "
"1","):"
"1"," "
"1","0.0612"
"1"," "
"1","
"
"0","# 7. Create data frame for ggplot"
"0","df <- data.frame(L1 = L1_norm)"
"0",""
"0","# 8. Plot histogram with Gamma PDFs (true vs MLE)"
"0","ggplot(df, aes(x = L1)) +"
"0","  geom_histogram(aes(y = ..density..), bins = 100, fill = ""skyblue"", alpha = 0.5) +"
"0","  stat_function(fun = function(x) dgamma(x, shape = d, rate = 1),"
"0","                color = ""red"", size = 1.2, linetype = ""solid"") +"
"0","  stat_function(fun = function(x) dgamma(x, shape = d, rate = lambda_mle),"
"0","                color = ""darkgreen"", size = 1.2, linetype = ""dashed"") +"
"0","  geom_vline(xintercept = u, color = ""black"", linetype = ""dashed"", size = 1) +"
"0","  annotate(""text"", x = u + 1, y = 0.05, label = paste(""Threshold u ="", u), color = ""black"") +"
"0","  labs("
"0","    title = ""L1 Norm ||X||₁ Distribution with MLE Fitting"","
"0","    subtitle = paste0("
"0","      ""Monte Carlo = "", round(p_mc, 5),"
"0","      "" | Analytic (true λ) = "", round(p_analytic_true, 5),"
"0","      "" | Analytic (MLE λ) = "", round(p_analytic_mle, 5)"
"0","    ),"
"0","    x = ""L1 Norm ||X||₁"", y = ""Density"""
"0","  ) +"
"0","  theme_minimal()"
