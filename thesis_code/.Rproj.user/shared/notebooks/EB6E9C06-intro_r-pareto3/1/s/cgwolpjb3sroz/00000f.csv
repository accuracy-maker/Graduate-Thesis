"0","sim_br_spectral <- function(n, coords, rho, alpha)"
"0","{"
"0","  gamma_h  <- function(h) (h / rho)^alpha"
"0","  Dmat     <- as.matrix(dist(coords))"
"0","  gamma_ij <- gamma_h(Dmat)"
"0",""
"0","  gamma0   <- gamma_h(sqrt(rowSums(coords^2)))     # γ(‖s_i‖)"
"0","  Sigma    <- 0.5 * outer(gamma0, gamma0, ""+"") - 0.5 * gamma_ij"
"0","  mu       <- -0.5 * diag(Sigma)"
"0",""
"0","  Y        <- mvtnorm::rmvnorm(n, mean = mu, sigma = Sigma)"
"0","  exp(Y)                                         #  n × d  matrix"
"0","}"
