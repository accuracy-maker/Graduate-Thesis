"0","loglik_MC <- function(par, Z_obs, coords,"
"0","                      n_MC = 5e4, h_bw = 0.015)"
"0","{"
"0","  rho   <- exp(par[1])"
"0","  alpha <- plogis(par[2]) * 2"
"0",""
"0","  Z_mc  <- sim_rPareto_BR(n_MC, coords, rho, alpha)"
"0","  acc   <- attr(Z_mc, ""accept.rate"")"
"0",""
"0","  clr <- function(z) log(z) - mean(log(z))"
"0","  Z_clr_mc  <- t(apply(Z_mc , 1, clr))"
"0","  Z_clr_obs <- t(apply(Z_obs, 1, clr))"
"0",""
"0","  kd <- ks::kde(x = Z_clr_mc,"
"0","                H = diag(h_bw, ncol(Z_clr_mc)),"
"0","                binned     = FALSE,"
"0","                eval.points = Z_clr_obs)"
"0",""
"0","  ll  <- sum(kd$estimate)              # Monte-Carlo log-likelihood"
"0","  attr(ll, ""acc.rate"") <- acc"
"0","  ll"
"0","}"
"0",""
